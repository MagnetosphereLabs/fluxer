{
	"passkeys": {
		"type": "object",
		"description": "WebAuthn/Passkeys relying party settings.",
		"additionalProperties": false,
		"properties": {
			"rp_name": {
				"type": "string",
				"description": "Relying Party name displayed to users.",
				"default": "Fluxer"
			},
			"rp_id": {
				"type": "string",
				"description": "Relying Party ID (domain) for WebAuthn credentials.",
				"default": "fluxer.app"
			},
			"additional_allowed_origins": {
				"type": "array",
				"description": "List of allowed origins for WebAuthn registration/authentication.",
				"items": {
					"type": "string"
				},
				"default": ["https://web.fluxer.app", "https://web.canary.fluxer.app"]
			}
		}
	},
	"bluesky_key": {
		"type": "object",
		"additionalProperties": false,
		"required": ["kid"],
		"properties": {
			"kid": {
				"type": "string",
				"description": "JSON Web Key ID used when signing private key JWTs."
			},
			"private_key": {
				"type": "string",
				"description": "PEM-encoded private key used to authenticate to the Bluesky token endpoint."
			},
			"private_key_path": {
				"type": "string",
				"description": "Absolute filesystem path to a PEM private key file. Must be an absolute path because services may run from different working directories. Use this instead of private_key to avoid embedding the key in the config."
			}
		},
		"anyOf": [
			{
				"required": ["private_key"]
			},
			{
				"required": ["private_key_path"]
			}
		]
	},
	"bluesky": {
		"type": "object",
		"description": "Bluesky OAuth client configuration.",
		"additionalProperties": false,
		"properties": {
			"enabled": {
				"type": "boolean",
				"description": "Whether Bluesky OAuth connections are enabled.",
				"default": true
			},
			"client_name": {
				"type": "string",
				"description": "Human-readable client name exposed to Bluesky.",
				"default": "Fluxer"
			},
			"client_uri": {
				"type": "string",
				"description": "URI describing the client application.",
				"default": ""
			},
			"logo_uri": {
				"type": "string",
				"description": "Optional logo presented during authorization.",
				"default": "https://fluxerstatic.com/web/apple-touch-icon.png"
			},
			"tos_uri": {
				"type": "string",
				"description": "Terms of service URI exposed to Bluesky.",
				"default": "https://fluxer.app/terms"
			},
			"policy_uri": {
				"type": "string",
				"description": "Privacy policy URI exposed to Bluesky.",
				"default": "https://fluxer.app/privacy"
			},
			"keys": {
				"type": "array",
				"description": "Key definitions used to sign private key JWT assertions.",
				"items": {
					"$ref": "#/$defs/bluesky_key"
				},
				"default": []
			}
		},
		"default": {
			"enabled": true,
			"client_name": "Fluxer",
			"client_uri": "",
			"logo_uri": "https://fluxerstatic.com/web/apple-touch-icon.png",
			"tos_uri": "https://fluxer.app/terms",
			"policy_uri": "https://fluxer.app/privacy",
			"keys": []
		}
	},
	"vapid": {
		"type": "object",
		"description": "VAPID keys for Web Push notifications.",
		"additionalProperties": false,
		"required": ["public_key", "private_key"],
		"properties": {
			"public_key": {
				"type": "string",
				"description": "VAPID Public Key."
			},
			"private_key": {
				"type": "string",
				"description": "VAPID Private Key."
			},
			"email": {
				"type": "string",
				"description": "Contact email included in push service requests.",
				"default": ""
			}
		}
	},
	"auth": {
		"type": "object",
		"description": "Global authentication configuration.",
		"additionalProperties": false,
		"required": ["vapid", "sudo_mode_secret", "connection_initiation_secret"],
		"properties": {
			"sudo_mode_secret": {
				"type": "string",
				"description": "Secret key for verifying sudo mode tokens."
			},
			"connection_initiation_secret": {
				"type": "string",
				"description": "Secret key for signing connection initiation tokens."
			},
			"passkeys": {
				"description": "Passkey configuration.",
				"$ref": "#/$defs/passkeys",
				"default": {}
			},
			"vapid": {
				"description": "Web Push VAPID configuration.",
				"$ref": "#/$defs/vapid"
			},
			"bluesky": {
				"description": "Bluesky OAuth client configuration.",
				"$ref": "#/$defs/bluesky",
				"default": {
					"enabled": true,
					"client_name": "Fluxer",
					"client_uri": "",
					"logo_uri": "https://fluxerstatic.com/web/apple-touch-icon.png",
					"tos_uri": "https://fluxer.app/terms",
					"policy_uri": "https://fluxer.app/privacy",
					"keys": []
				}
			}
		}
	},
	"cookie": {
		"type": "object",
		"description": "Session cookie configuration.",
		"additionalProperties": false,
		"properties": {
			"domain": {
				"type": "string",
				"description": "Domain attribute for cookies. Leave empty for host-only.",
				"default": ""
			},
			"secure": {
				"type": "boolean",
				"description": "If true, sets the Secure flag on cookies.",
				"default": false
			}
		}
	},
	"gateway_connection": {
		"type": "object",
		"description": "Configuration for backend services to call the Gateway via RPC.",
		"additionalProperties": false,
		"required": ["rpc_secret"],
		"properties": {
			"rpc_endpoint": {
				"type": "string",
				"description": "Gateway RPC endpoint URL (e.g. http://gateway:8080).",
				"default": "http://127.0.0.1:8088"
			},
			"rpc_secret": {
				"type": "string",
				"description": "Shared secret for authenticating RPC calls to the Gateway."
			}
		}
	}
}
